# ë‹¬ëŸ¬ë‹´ìœ¼ëŸ¬.py â€“ ì™¸í™˜ ë”œëŸ¬ ë²„ì „ (200ì¼ì„  ë‹¨ì¼ ê¸°ì¤€)
import pandas as pd
import yfinance as yf
from datetime import datetime, timedelta

# ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
ticker = yf.Ticker("USDKRW=X")
df = ticker.history(period="2y", interval="1d")   # 2ë…„ ë°ì´í„°ë©´ 200ì¼ì„  ì¶©ë¶„
df = df[['Close']].rename(columns={'Close': 'í™˜ìœ¨'})

# 200ì¼ ì´ë™í‰ê·  (ì™¸í™˜ ë”œëŸ¬ì˜ ìƒëª…ì„ )
df['200ì¼ì„ '] = df['í™˜ìœ¨'].rolling(window=200).mean()

# ì˜¤ëŠ˜ ë°ì´í„°
ì˜¤ëŠ˜ = df.iloc[-1]
í˜„ì¬í™˜ìœ¨ = ì˜¤ëŠ˜['í™˜ìœ¨']
ì´í‰200 = ì˜¤ëŠ˜['200ì¼ì„ ']

# ë‹¨ì¼ ë£° íŒë‹¨
if í˜„ì¬í™˜ìœ¨ <= ì´í‰200:
    ì‹ í˜¸ = "ğŸ¯ ë‹´ì•„ë¼!! (200ì¼ì„  ì•„ë˜ = ì¥ê¸° ì €ì )"
    ì¶”ì²œ = "ì§€ê¸ˆì´ ì™¸í™˜ ë”œëŸ¬ë“¤ì´ ëŒ€ëŸ‰ ë§¤ìˆ˜ ë“¤ì–´ê°€ëŠ” êµ¬ê°„ì…ë‹ˆë‹¤!"
else:
    ì°¨ì´ = í˜„ì¬í™˜ìœ¨ - ì´í‰200
    í¼ì„¼íŠ¸ = ì°¨ì´ / ì´í‰200 * 100
    ì‹ í˜¸ = f"â³ ëŒ€ê¸° (200ì¼ì„ ë³´ë‹¤ {ì°¨ì´:.0f}ì› ({í¼ì„¼íŠ¸:.1f}%) ë¹„ìŒˆ)"
    ì¶”ì²œ = f"200ì¼ì„ ({ì´í‰200:.0f}ì›) ê·¼ì²˜ê¹Œì§€ ê¸°ë‹¤ë¦¬ì„¸ìš”."

# ì¶œë ¥
print("â• ë‹¬ëŸ¬ë‹´ìœ¼ëŸ¬ â€“ ì™¸í™˜ ë”œëŸ¬ ì—ë””ì…˜ (200ì¼ì„  ë‹¨ì¼ ë£°) â•")
print(f"í˜„ì¬ í™˜ìœ¨ : {í˜„ì¬í™˜ìœ¨:,.2f}ì›")
print(f"200ì¼ì„    : {ì´í‰200:,.2f}ì›")
print(f"ì˜¤ëŠ˜ ì‹ í˜¸ : {ì‹ í˜¸}")
print(ì¶”ì²œ)
print("\nìµœê·¼ 5ì¼")
print(df[['í™˜ìœ¨', '200ì¼ì„ ']].tail(5).round(2))
